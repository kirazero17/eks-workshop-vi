<!DOCTYPE html>
<html lang="vi" class="js csstransforms3d">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="generator" content="Hugo 0.122.0">
    <meta name="description" content="">
<meta name="author" content="journeyoftheaverageguy@gmail.com">

    <link rel="icon" href="/images/favicon.png" type="image/png">

    <title>Các Bước Chuẩn Bị :: KUBERNETES ON AWS WORKSHOP</title>

    
    <link href="/css/nucleus.css?1711440727" rel="stylesheet">
    <link href="/css/fontawesome-all.min.css?1711440727" rel="stylesheet">
    <link href="/css/hybrid.css?1711440727" rel="stylesheet">
    <link href="/css/featherlight.min.css?1711440727" rel="stylesheet">
    <link href="/css/perfect-scrollbar.min.css?1711440727" rel="stylesheet">
    <link href="/css/auto-complete.css?1711440727" rel="stylesheet">
    <link href="/css/atom-one-dark-reasonable.css?1711440727" rel="stylesheet">
    <link href="/css/theme.css?1711440727" rel="stylesheet">
    <link href="/css/hugo-theme.css?1711440727" rel="stylesheet">
    
    <link href="/css/theme-workshop.css?1711440727" rel="stylesheet">
    
    

    <script src="/js/jquery-3.3.1.min.js?1711440727"></script>

    <style>
      :root #header + #content > #left > #rlblock_left{
          display:none !important;
      }
      
    </style>
    
  </head>
  <body class="" data-url="/vi/3-ebs/3.1-statefulsets/">
    <nav id="sidebar" class="showVisitedLinks">



  <div id="header-wrapper">
    <div id="header">
      <a id="logo" href="/">

<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 60 30" width="30%"><defs><style>.cls-1{fill:#fff;}.cls-2{fill:#f90;fill-rule:evenodd;}</style></defs><title>AWS-Logo_White-Color</title><path class="cls-1" d="M14.09,10.85a4.7,4.7,0,0,0,.19,1.48,7.73,7.73,0,0,0,.54,1.19.77.77,0,0,1,.12.38.64.64,0,0,1-.32.49l-1,.7a.83.83,0,0,1-.44.15.69.69,0,0,1-.49-.23,3.8,3.8,0,0,1-.6-.77q-.25-.42-.51-1a6.14,6.14,0,0,1-4.89,2.3,4.54,4.54,0,0,1-3.32-1.19,4.27,4.27,0,0,1-1.22-3.2A4.28,4.28,0,0,1,3.61,7.75,6.06,6.06,0,0,1,7.69,6.46a12.47,12.47,0,0,1,1.76.13q.92.13,1.91.36V5.73a3.65,3.65,0,0,0-.79-2.66A3.81,3.81,0,0,0,7.86,2.3a7.71,7.71,0,0,0-1.79.22,12.78,12.78,0,0,0-1.79.57,4.55,4.55,0,0,1-.58.22l-.26,0q-.35,0-.35-.52V2a1.09,1.09,0,0,1,.12-.58,1.2,1.2,0,0,1,.47-.35A10.88,10.88,0,0,1,5.77.32,10.19,10.19,0,0,1,8.36,0a6,6,0,0,1,4.35,1.35,5.49,5.49,0,0,1,1.38,4.09ZM7.34,13.38a5.36,5.36,0,0,0,1.72-.31A3.63,3.63,0,0,0,10.63,12,2.62,2.62,0,0,0,11.19,11a5.63,5.63,0,0,0,.16-1.44v-.7a14.35,14.35,0,0,0-1.53-.28,12.37,12.37,0,0,0-1.56-.1,3.84,3.84,0,0,0-2.47.67A2.34,2.34,0,0,0,5,11a2.35,2.35,0,0,0,.61,1.76A2.4,2.4,0,0,0,7.34,13.38Zm13.35,1.8a1,1,0,0,1-.64-.16,1.3,1.3,0,0,1-.35-.65L15.81,1.51a3,3,0,0,1-.15-.67.36.36,0,0,1,.41-.41H17.7a1,1,0,0,1,.65.16,1.4,1.4,0,0,1,.33.65l2.79,11,2.59-11A1.17,1.17,0,0,1,24.39.6a1.1,1.1,0,0,1,.67-.16H26.4a1.1,1.1,0,0,1,.67.16,1.17,1.17,0,0,1,.32.65L30,12.39,32.88,1.25A1.39,1.39,0,0,1,33.22.6a1,1,0,0,1,.65-.16h1.54a.36.36,0,0,1,.41.41,1.36,1.36,0,0,1,0,.26,3.64,3.64,0,0,1-.12.41l-4,12.86a1.3,1.3,0,0,1-.35.65,1,1,0,0,1-.64.16H29.25a1,1,0,0,1-.67-.17,1.26,1.26,0,0,1-.32-.67L25.67,3.64,23.11,14.34a1.26,1.26,0,0,1-.32.67,1,1,0,0,1-.67.17Zm21.36.44a11.28,11.28,0,0,1-2.56-.29,7.44,7.44,0,0,1-1.92-.67,1,1,0,0,1-.61-.93v-.84q0-.52.38-.52a.9.9,0,0,1,.31.06l.42.17a8.77,8.77,0,0,0,1.83.58,9.78,9.78,0,0,0,2,.2,4.48,4.48,0,0,0,2.43-.55,1.76,1.76,0,0,0,.86-1.57,1.61,1.61,0,0,0-.45-1.16A4.29,4.29,0,0,0,43,9.22l-2.41-.76A5.15,5.15,0,0,1,38,6.78a3.94,3.94,0,0,1-.83-2.41,3.7,3.7,0,0,1,.45-1.85,4.47,4.47,0,0,1,1.19-1.37A5.27,5.27,0,0,1,40.51.29,7.4,7.4,0,0,1,42.6,0a8.87,8.87,0,0,1,1.12.07q.57.07,1.08.19t.95.26a4.27,4.27,0,0,1,.7.29,1.59,1.59,0,0,1,.49.41.94.94,0,0,1,.15.55v.79q0,.52-.38.52a1.76,1.76,0,0,1-.64-.2,7.74,7.74,0,0,0-3.2-.64,4.37,4.37,0,0,0-2.21.47,1.6,1.6,0,0,0-.79,1.48,1.58,1.58,0,0,0,.49,1.18,4.94,4.94,0,0,0,1.83.92L44.55,7a5.08,5.08,0,0,1,2.57,1.6A3.76,3.76,0,0,1,47.9,11a4.21,4.21,0,0,1-.44,1.93,4.4,4.4,0,0,1-1.21,1.47,5.43,5.43,0,0,1-1.85.93A8.25,8.25,0,0,1,42.05,15.62Z"></path><path class="cls-2" d="M45.19,23.81C39.72,27.85,31.78,30,25,30A36.64,36.64,0,0,1,.22,20.57c-.51-.46-.06-1.09.56-.74A49.78,49.78,0,0,0,25.53,26.4,49.23,49.23,0,0,0,44.4,22.53C45.32,22.14,46.1,23.14,45.19,23.81Z"></path><path class="cls-2" d="M47.47,21.21c-.7-.9-4.63-.42-6.39-.21-.53.06-.62-.4-.14-.74,3.13-2.2,8.27-1.57,8.86-.83s-.16,5.89-3.09,8.35c-.45.38-.88.18-.68-.32C46.69,25.8,48.17,22.11,47.47,21.21Z"></path></svg>

</a>

    </div>
    
        <div class="searchbox">
    <label for="search-by"><i class="fas fa-search"></i></label>
    <input data-search-input id="search-by" type="search" placeholder="Search...">
    <span data-search-clear=""><i class="fas fa-times"></i></span>
</div>

<script type="text/javascript" src="/js/lunr.min.js?1711440727"></script>
<script type="text/javascript" src="/js/auto-complete.js?1711440727"></script>
<script type="text/javascript">
    
        var baseurl = "\/vi";
    
</script>
<script type="text/javascript" src="/js/search.js?1711440727"></script>

    
  </div>

    <div class="highlightable">
    <ul class="topics">

        
          
          




 
  
    
    <li data-nav-id="/vi/1-introduce/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduce/">
          <b> 1. </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/1-introduce/1.1-docker-storage/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduce/1.1-docker-storage/">
          <b> 1.1 </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/1-introduce/1.2-storage/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduce/1.2-storage/">
          <b> 1.2 </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/1-introduce/1.3-volume-driver-plugins-in-docker/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduce/1.3-volume-driver-plugins-in-docker/">
          <b> 1.3 </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/1-introduce/1.4-container-storage-interface/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduce/1.4-container-storage-interface/">
          <b> 1.4 </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/1-introduce/1.5-volumes/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduce/1.5-volumes/">
          <b> 1.5 </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/1-introduce/1.6-persistent-volumes/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduce/1.6-persistent-volumes/">
          <b> 1.6 </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/1-introduce/1.7-persistent-volume-claims/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduce/1.7-persistent-volume-claims/">
          <b> 1.7 </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/1-introduce/1.8-using-pvc-in-pods/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduce/1.8-using-pvc-in-pods/">
          <b> 1.8 </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/1-introduce/1.9-storage-class/" title="Giới thiệu" class="dd-item 
        
        
        
        ">
      <a href="/vi/1-introduce/1.9-storage-class/">
          <b> 1.9 </b>Giới thiệu
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/2-prerequiste/" title="Các Bước Chuẩn Bị" class="dd-item 
        
        
        
        ">
      <a href="/vi/2-prerequiste/">
          <b> 2. </b>Các Bước Chuẩn Bị
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/3-ebs/" title="Các Bước Chuẩn Bị" class="dd-item 
        parent
        
        
        ">
      <a href="/vi/3-ebs/">
          <b> 3. </b>Các Bước Chuẩn Bị
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/3-ebs/3.1-statefulsets/" title="Các Bước Chuẩn Bị" class="dd-item 
        
        active
        
        ">
      <a href="/vi/3-ebs/3.1-statefulsets/">
          <b> 3.1 </b>Các Bước Chuẩn Bị
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/3-ebs/3.2-ebs-csi-driver/" title="Các Bước Chuẩn Bị" class="dd-item 
        
        
        
        ">
      <a href="/vi/3-ebs/3.2-ebs-csi-driver/">
          <b> 3.2 </b>Các Bước Chuẩn Bị
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/3-ebs/3.3-statefulset-with-ebs-volume/" title="Các Bước Chuẩn Bị" class="dd-item 
        
        
        
        ">
      <a href="/vi/3-ebs/3.3-statefulset-with-ebs-volume/">
          <b> 3.3 </b>Các Bước Chuẩn Bị
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
          




 
  
    
    <li data-nav-id="/vi/4-amazon-efs/" title="Các Bước Chuẩn Bị" class="dd-item 
        
        
        
        ">
      <a href="/vi/4-amazon-efs/">
          <b> 4. </b>Các Bước Chuẩn Bị
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
      
        <ul>
          
          
            
          
          
          
        
          
            
            




 
  
    
    <li data-nav-id="/vi/4-amazon-efs/4.1/" title="Các Bước Chuẩn Bị" class="dd-item 
        
        
        
        ">
      <a href="/vi/4-amazon-efs/4.1/">
          <b> 4.1 </b>Các Bước Chuẩn Bị
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/4-amazon-efs/4.2/" title="Các Bước Chuẩn Bị" class="dd-item 
        
        
        
        ">
      <a href="/vi/4-amazon-efs/4.2/">
          <b> 4.2 </b>Các Bước Chuẩn Bị
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
            
            




 
  
    
    <li data-nav-id="/vi/4-amazon-efs/4.3/" title="Các Bước Chuẩn Bị" class="dd-item 
        
        
        
        ">
      <a href="/vi/4-amazon-efs/4.3/">
          <b> 4.3 </b>Các Bước Chuẩn Bị
          
            <i class="fas fa-check read-icon"></i>
          
      </a>
      
              
    </li>
  
 

            
          
        
        </ul>
              
    </li>
  
 

          
         
    </ul>

    
    
      <section id="shortcuts">
        <h3>More</h3>
        <ul>
          
              <li> 
                  <a class="padding" href="http://awsstudygroup.com"><i class='fab fa-aws'></i> AWS Study Group - Blog</a>
              </li>
          
              <li> 
                  <a class="padding" href="https://www.facebook.com/groups/awsstudygroupfcj"><i class='fab fa-facebook'></i> AWS Study Group - Nhóm FB</a>
              </li>
          
        </ul>
      </section>
    

    
    <section id="prefooter">
      <hr/>
      <ul>
      
        <li>
          <a class="padding">
            <i class="fas fa-language fa-fw"></i>
          <div class="select-style">
            <select id="select-language" onchange="location = this.value;">
          
          
          
              
              
                  
              
                  
                    
                    
                      <option id="vi" value="/vi/3-ebs/3.1-statefulsets/" selected>Tiếng Việt</option>
                    
                  
              
          
        </select>
        <svg version="1.1" id="Capa_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px"
          width="255px" height="255px" viewBox="0 0 255 255" style="enable-background:new 0 0 255 255;" xml:space="preserve">
          <g>
            <g id="arrow-drop-down">
              <polygon points="0,63.75 127.5,191.25 255,63.75 		" />
            </g>
          </g>
        </svg>
        </div>
        </a>
        </li>
      
      
      
        <li><a class="padding" href="#" data-clear-history-toggle=""><i class="fas fa-history fa-fw"></i> Clear History</a></li>
      
      </ul>
    </section>
    
    <section id="footer">
      <left>
    
     <b> Workshop</b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=11626245&style=0038&nbdigits=9&type=page&initCount=0" title="Migrate" Alt="web counter"   border="0" /></a>  <br>
     <b> <a href="https://cloudjourney.awsstudygroup.com/">Cloud Journey</a></b> <br>
    <img src="https://hitwebcounter.com/counter/counter.php?page=7830807&style=0038&nbdigits=9&type=page&initCount=0" title="Total CLoud Journey" Alt="web counter"   border="0"   />
     
</left>
<left>
    <br>
    <br>
        <b> Last Updated </b> <br>
        <i><font color=orange>26-02-2024</font></i>
    </left>
    <left>
        <br>
        <br>
            <b> Team </b> <br>
            <i> <a href="https://www.linkedin.com/in/jotaguy"  style="color:orange">Gia Hưng </a> <br>
        </i>
        </left>

<script async defer src="https://buttons.github.io/buttons.js"></script>

    </section>
  </div>
</nav>




        <section id="body">
        <div id="overlay"></div>
        <div class="padding highlightable">
              
              <div>
                <div id="top-bar">
                
                
                <div id="breadcrumbs" itemscope="" itemtype="http://data-vocabulary.org/Breadcrumb">
                    <span id="sidebar-toggle-span">
                        <a href="#" id="sidebar-toggle" data-sidebar-toggle="">
                          <i class="fas fa-bars"></i>
                        </a>
                    </span>
                  
                  <span id="toc-menu"><i class="fas fa-list-alt"></i></span>
                  
                  <span class="links">
                 
                 
                    
          
          
            
            
          
          
            
            
          
          
            <a href='/vi/'>Kubernetes trên AWS</a> > <a href='/vi/3-ebs/'>Các Bước Chuẩn Bị</a> > Các Bước Chuẩn Bị
          
        
          
        
          
        
                 
                  </span>
                </div>
                
                    <div class="progress">
    <div class="wrapper">
<nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li></li>
      </ul>
    </li>
  </ul>
</nav>
    </div>
</div>

                
              </div>
            </div>
            
        <div id="head-tags">
        
        </div>
        
        <div id="body-inner">
          
            <h1>
              
              Các Bước Chuẩn Bị
            </h1>
          

        



	<h4 id="các-bước-chuẩn-bị">Các Bước Chuẩn Bị</h4>
<p>Tương tự như Deployments, <a href="https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/">StatefulSets</a> quản lý các Pods dựa trên một container spec đồng nhất. Khác với Deployments, StatefulSets duy trì một danh tính cố định cho mỗi Pod của nó. Các Pods này được tạo ra từ cùng một spec, nhưng không thể hoán đổi với nhau, mỗi Pod có một định danh bền vững mà nó duy trì qua bất kỳ sự kiện lên lịch lại nào.</p>
<p>Nếu bạn muốn sử dụng các thùng chứa lưu trữ để cung cấp tính bền vững cho công việc của mình, bạn có thể sử dụng StatefulSet như một phần của giải pháp. Mặc dù các Pods riêng lẻ trong một StatefulSet có thể gặp sự cố, các định danh Pod bền vững làm cho việc phù hợp các thùng chứa hiện có với các Pods mới thay thế bất kỳ Pod nào đã thất bại trở nên dễ dàng hơn.</p>
<p>StatefulSets là có giá trị cho các ứng dụng yêu cầu một hoặc nhiều trong các yếu tố sau:</p>
<ul>
<li>Các định danh mạng ổn định, duy nhất</li>
<li>Lưu trữ ổn định, bền vững</li>
<li>Triển khai và mở rộng dịch vụ một cách đặt hàng, lịch sự</li>
<li>Cập nhật cuộn tự động, đặt hàng</li>
</ul>
<p>Trong ứng dụng thương mại điện tử của chúng tôi, chúng tôi đã triển khai một StatefulSet như một phần của dịch vụ nhỏ Catalog. Dịch vụ nhỏ Catalog sử dụng cơ sở dữ liệu MySQL chạy trên EKS. Cơ sở dữ liệu là một ví dụ tốt cho việc sử dụng StatefulSets vì chúng đòi hỏi <strong>lưu trữ bền vững</strong>. Chúng ta có thể phân tích Pod MySQL Database của chúng ta để xem cấu hình thùng chứa hiện tại của nó:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl describe statefulset -n catalog catalog-mysql
</span></span><span style="display:flex;"><span>Name:               catalog-mysql
</span></span><span style="display:flex;"><span>Namespace:          catalog
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span><span style="display:flex;"><span>  Containers:
</span></span><span style="display:flex;"><span>   mysql:
</span></span><span style="display:flex;"><span>    Image:      public.ecr.aws/docker/library/mysql:5.7
</span></span><span style="display:flex;"><span>    Port:       3306/TCP
</span></span><span style="display:flex;"><span>    Host Port:  0/TCP
</span></span><span style="display:flex;"><span>    Args:
</span></span><span style="display:flex;"><span>      --ignore-db-dir<span style="color:#f92672">=</span>lost+found
</span></span><span style="display:flex;"><span>    Environment:
</span></span><span style="display:flex;"><span>      MYSQL_ROOT_PASSWORD:  my-secret-pw
</span></span><span style="display:flex;"><span>      MYSQL_USER:           &lt;set to the key <span style="color:#e6db74">&#39;username&#39;</span> in secret <span style="color:#e6db74">&#39;catalog-db&#39;</span>&gt;  Optional: false
</span></span><span style="display:flex;"><span>      MYSQL_PASSWORD:       &lt;set to the key <span style="color:#e6db74">&#39;password&#39;</span> in secret <span style="color:#e6db74">&#39;catalog-db&#39;</span>&gt;  Optional: false
</span></span><span style="display:flex;"><span>      MYSQL_DATABASE:       &lt;set to the key <span style="color:#e6db74">&#39;name&#39;</span> in secret <span style="color:#e6db74">&#39;catalog-db&#39;</span>&gt;      Optional: false
</span></span><span style="display:flex;"><span>    Mounts:
</span></span><span style="display:flex;"><span>      /var/lib/mysql from data <span style="color:#f92672">(</span>rw<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>  Volumes:
</span></span><span style="display:flex;"><span>   data:
</span></span><span style="display:flex;"><span>    Type:       EmptyDir <span style="color:#f92672">(</span>a temporary directory that shares a pod<span style="color:#960050;background-color:#1e0010">&#39;</span>s lifetime<span style="color:#f92672">)</span>
</span></span><span style="display:flex;"><span>    Medium:
</span></span><span style="display:flex;"><span>    SizeLimit:  &lt;unset&gt;
</span></span><span style="display:flex;"><span>Volume Claims:  &lt;none&gt;
</span></span><span style="display:flex;"><span><span style="color:#f92672">[</span>...<span style="color:#f92672">]</span>
</span></span></code></pre></div><p>Như bạn có thể thấy phần <a href="https://kubernetes.io/docs/concepts/storage/volumes/#emptydir-configuration-example"><code>Volumes</code></a> của StatefulSet của chúng ta cho thấy chúng ta chỉ sử dụng một loại thùng chứa <a href="https://kubernetes.io/docs/concepts/storage/volumes/#emptydir">EmptyDir</a> mà &ldquo;chia sẻ với tuổi thọ của Pod&rdquo;.</p>
<p><img src="./assets/mysql-emptydir.png" alt="MySQL với emptyDir"></p>
<p>Một thùng chứa <code>emptyDir</code> được tạo ra khi một Pod được gán cho một nút, và tồn tại trong suốt thời gian mà Pod đó đang chạy trên nút đó. Như tên gọi của nó, thùng chứa emptyDir ban đầu là trống. Tất cả các container trong Pod có thể đọc và ghi các tệp tin trong thùng chứa emptyDir, mặc dù thùng chứa đó có thể được gắn vào các đường dẫn giống nhau hoặc khác nhau trong mỗi container. <strong>Khi một Pod được xóa khỏi một nút vì bất kỳ lý do nào, dữ liệu trong emptyDir sẽ bị xóa một cách vĩnh viễn.</strong> Do đó, EmptyDir không phù hợp cho cơ sở dữ liệu MySQL của chúng ta.</p>
<p>Chúng ta có thể minh họa điều này bằng cách bắt đầu một phiên shell bên trong container MySQL và tạo một tệp tin thử nghiệm. Sau đó, chúng ta sẽ xóa Pod đang chạy trong StatefulSet của chúng ta. Bởi vì Pod đang sử dụng emptyDir và không phải là Persistent Volume (PV), tệp tin sẽ không tồn tại sau khi Pod được khởi động lại. Đầu tiên, hãy chạy một lệnh bên trong container MySQL của chúng ta để tạo một tệp tin trong đường dẫn emptyDir <code>/var/lib/mysql</code> (nơi MySQL lưu trữ các tệp cơ sở dữ liệu):</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl exec catalog-mysql-0 -n catalog -- bash -c  <span style="color:#e6db74">&#34;echo 123 &gt; /var/lib/mysql/test.txt&#34;</span>
</span></span></code></pre></div><p>Bây giờ, hãy xác minh rằng tệp <code>test.txt</code> của chúng ta đã được tạo trong thư mục <code>/var/lib/mysql</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl exec catalog-mysql-0 -n catalog -- ls -larth /var/lib/mysql/ | grep -i test
</span></span><span style="display:flex;"><span>-rw-r--r-- <span style="color:#ae81ff">1</span> root  root     <span style="color:#ae81ff">4</span> Oct <span style="color:#ae81ff">18</span> 13:38 test.txt
</span></span></code></pre></div><p>Bây giờ, hãy xóa Pod <code>catalog-mysql</code> hiện tại. Điều này sẽ buộc bộ điều khiển StatefulSet tự động tạo lại một Pod <code>catalog-mysql</code> mới:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl delete pods -n catalog -l app.kubernetes.io/component<span style="color:#f92672">=</span>mysql
</span></span><span style="display:flex;"><span>pod <span style="color:#e6db74">&#34;catalog-mysql-0&#34;</span> deleted
</span></span></code></pre></div><p>Chờ một vài giây và chạy lệnh dưới đây để kiểm tra xem Pod <code>catalog-mysql</code> đã được tạo lại chưa:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl wait --for<span style="color:#f92672">=</span>condition<span style="color:#f92672">=</span>Ready pod -n catalog <span style="color:#ae81ff">\
</span></span></span><span style="display:flex;"><span><span style="color:#ae81ff"></span>  -l app.kubernetes.io/component<span style="color:#f92672">=</span>mysql --timeout<span style="color:#f92672">=</span>30s
</span></span><span style="display:flex;"><span>pod/catalog-mysql-0 condition met
</span></span><span style="display:flex;"><span>$ kubectl get pods -n catalog -l app.kubernetes.io/component<span style="color:#f92672">=</span>mysql
</span></span><span style="display:flex;"><span>NAME              READY   STATUS    RESTARTS   AGE
</span></span><span style="display:flex;"><span>catalog-mysql-0   1/1     Running   <span style="color:#ae81ff">0</span>          29s
</span></span></code></pre></div><p>Cuối cùng, hãy thực hiện lại vào shell của container MySQL và chạy một lệnh <code>ls</code> trong đường dẫn <code>/var/lib/mysql</code> để tìm tệp <code>test.txt</code> đã được tạo trước đó:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>$ kubectl exec catalog-mysql-0 -n catalog -- cat /var/lib/mysql/test.txt
</span></span><span style="display:flex;"><span>cat: /var/lib/mysql/test.txt: No such file or directory
</span></span><span style="display:flex;"><span>command terminated with exit code <span style="color:#ae81ff">1</span>
</span></span></code></pre></div><p>Như bạn có thể thấy, tệp <code>test.txt</code> không còn tồn tại nữa do các thư mục <code>emptyDir</code> là tạm thời. Trong các phần tiếp theo, chúng ta sẽ thực hiện cùng một thử nghiệm và thể hiện cách Persistent Volumes (PVs) sẽ duy trì tệp <code>test.txt</code> và tồn tại qua các lần khởi động lại và/hoặc sự cố của Pod.</p>
<p>Trên trang tiếp theo, chúng ta sẽ làm việc để hiểu các khái niệm chính về Lưu trữ trên Kubernetes và tích hợp của nó với hệ sinh thái đám mây AWS.</p>





<footer class=" footline" >
	
</footer>

        
        </div> 
        

      </div>

    <div id="navigation">
        
        
        
        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                        
                        
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                        
                    
                    

                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
                        
            
            
                
                    
                
                

                    
                    
                    

                    
            
        
                    
            
        
                    
            
        
        
        


	 
	 
		
			<a class="nav nav-prev" href="/vi/3-ebs/" title="Các Bước Chuẩn Bị"> <i class="fa fa-chevron-left"></i></a>
		
		
			<a class="nav nav-next" href="/vi/3-ebs/3.2-ebs-csi-driver/" title="Các Bước Chuẩn Bị" style="margin-right: 0px;"><i class="fa fa-chevron-right"></i></a>
		
	
    </div>

    </section>
    
    <div style="left: -1000px; overflow: scroll; position: absolute; top: -1000px; border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;">
      <div style="border: none; box-sizing: content-box; height: 200px; margin: 0px; padding: 0px; width: 200px;"></div>
    </div>
    <script src="/js/clipboard.min.js?1711440727"></script>
    <script src="/js/perfect-scrollbar.min.js?1711440727"></script>
    <script src="/js/perfect-scrollbar.jquery.min.js?1711440727"></script>
    <script src="/js/jquery.sticky.js?1711440727"></script>
    <script src="/js/featherlight.min.js?1711440727"></script>
    <script src="/js/highlight.pack.js?1711440727"></script>
    <script>hljs.initHighlightingOnLoad();</script>
    <script src="/js/modernizr.custom-3.6.0.js?1711440727"></script>
    <script src="/js/learn.js?1711440727"></script>
    <script src="/js/hugo-learn.js?1711440727"></script>

    <link href="/mermaid/mermaid.css?1711440727" rel="stylesheet" />
    <script src="/mermaid/mermaid.js?1711440727"></script>
    <script>
        mermaid.initialize({ startOnLoad: true });
    </script>
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-158079754-2', 'auto');
  ga('send', 'pageview');

</script>
  </body>
</html>
